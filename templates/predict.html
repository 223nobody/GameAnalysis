<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PUBG åƒé¸¡æ¦‚ç‡é¢„æµ‹å™¨</title>
    <style>
      body {
        font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
        color: #e0e0e0;
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 96%;
      }
      .container {
        padding: 2rem;
        width: 100%;
        max-width: 500px;
        margin: 40px auto;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        box-shadow: 0 12px 36px rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(12px);
        box-sizing: border-box;
        text-align: center;
      }
      h1 {
        text-align: center;
        color: #22d3ee;
        margin-bottom: 1.5rem;
      }
      .form-group {
        margin-bottom: 1rem;
      }
      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
      }
      .form-group input,
      .form-group select {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-sizing: border-box;
        font-size: 1rem;
      }
      button {
        width: 100%;
        padding: 0.8rem;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 1.1rem;
        cursor: pointer;
        transition: background-color 0.3s;
      }
      button:hover {
        background-color: #0056b3;
      }
      #result {
        margin-top: 1.5rem;
        text-align: center;
        font-size: 1.5rem;
        font-weight: bold;
        color: #28a745;
        height: 2rem;
      }
      /* å¯¼èˆªæ æ ·å¼å·²åœ¨å¤–éƒ¨CSSä¸­ç»Ÿä¸€å®šä¹‰ */
    </style>
  </head>
  <body>
    <div class="container">
      <div class="nav">
        <a href="/">é¦–é¡µ</a>
        <a href="/predict" class="active">é¢„æµ‹å™¨</a>
        <a href="/history">å†å²è®°å½•</a>
      </div>
      <h1>PUBG åƒé¸¡æ¦‚ç‡é¢„æµ‹å™¨ ğŸ”</h1>
      <form id="prediction-form">
        <div class="form-group">
          <label for="match_mode">æ¯”èµ›æ¨¡å¼</label>
          <select id="match_mode" name="match_mode" required>
            <option value="squad-fpp">å››æ’ (Squad-FPP)</option>
            <option value="duo-fpp">åŒæ’ (Duo-FPP)</option>
            <option value="solo-fpp">å•æ’ (Solo-FPP)</option>
          </select>
        </div>
        <div class="form-group">
          <label for="game_size">æ¸¸æˆæ€»äººæ•°</label
          ><input
            type="number"
            id="game_size"
            name="game_size"
            value="98"
            required
          />
        </div>
        <div class="form-group">
          <label for="party_size">é˜Ÿä¼è§„æ¨¡</label
          ><input
            type="number"
            id="party_size"
            name="party_size"
            value="4"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_kills">å‡»æ€æ•°</label
          ><input
            type="number"
            id="player_kills"
            name="player_kills"
            value="2"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_dmg">é€ æˆä¼¤å®³</label
          ><input
            type="number"
            id="player_dmg"
            name="player_dmg"
            value="250"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_dbno">å‡»å€’æ•°</label
          ><input
            type="number"
            id="player_dbno"
            name="player_dbno"
            value="1"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_assists">åŠ©æ”»æ•°</label
          ><input
            type="number"
            id="player_assists"
            name="player_assists"
            value="1"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_survive_time">ç”Ÿå­˜æ—¶é—´ (ç§’)</label
          ><input
            type="number"
            step="any"
            id="player_survive_time"
            name="player_survive_time"
            value="1500"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_dist_walk">æ­¥è¡Œè·ç¦» (ç±³)</label
          ><input
            type="number"
            step="any"
            id="player_dist_walk"
            name="player_dist_walk"
            value="2000"
            required
          />
        </div>
        <div class="form-group">
          <label for="player_dist_ride">è½½å…·è¡Œé©¶è·ç¦» (ç±³)</label
          ><input
            type="number"
            step="any"
            id="player_dist_ride"
            name="player_dist_ride"
            value="1000"
            required
          />
        </div>

        <button type="submit">å¼€å§‹é¢„æµ‹</button>
      </form>
      <div id="result"></div>
    </div>

    <script>
      // ç›‘å¬è¡¨å•çš„æäº¤äº‹ä»¶
      document
        .getElementById("prediction-form")
        .addEventListener("submit", function (event) {
          // é˜»æ­¢è¡¨å•çš„é»˜è®¤æäº¤è¡Œä¸ºï¼ˆé˜²æ­¢é¡µé¢åˆ·æ–°ï¼‰
          event.preventDefault();

          // è·å–è¡¨å•æ•°æ®
          const formData = new FormData(this);
          const data = Object.fromEntries(formData.entries());

          // å°†ç»“æœåŒºåŸŸæ¸…ç©ºå¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
          const resultDiv = document.getElementById("result");
          resultDiv.textContent = "æ­£åœ¨è®¡ç®—...";

          // ä½¿ç”¨ fetch API å°†æ•°æ®ä»¥ POST è¯·æ±‚å‘é€åˆ° Flask åç«¯
          fetch("/api/predict", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          })
            .then((response) => response.json()) // å°†è¿”å›çš„å“åº”è§£æä¸º JSON
            .then((result) => {
              // å¤„ç†åç«¯è¿”å›çš„ç»“æœ
              if (result.error) {
                resultDiv.style.color = "red";
                resultDiv.textContent = "é”™è¯¯: " + result.error;
              } else {
                const probability = (result.probability * 100).toFixed(2);
                resultDiv.style.color = "#28a745";
                resultDiv.textContent = `æœ¬åœºåƒé¸¡æ¦‚ç‡: ${probability}%`;
              }
            })
            .catch((error) => {
              // å¤„ç†ç½‘ç»œè¯·æ±‚é”™è¯¯
              console.error("Error:", error);
              resultDiv.style.color = "red";
              resultDiv.textContent = "è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¼€å¯ã€‚";
            });
        });
    </script>
  </body>
</html>
